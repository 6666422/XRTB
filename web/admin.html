<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta content="Bootstrap static html page for campaign administration."
    name="description">
    <meta content=
    "RTB,OpenRTB,JAVA,Advertising,real-time,campaign,administration" name=
    "keywords">
    <meta content="RTB4FREE" name="author">

    <title>RTB4FREE Monitor</title>
    <link href=
    "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"
    rel="stylesheet">
    <link href=
    "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css"
    rel="stylesheet">
    <link href="bootstrap-dialog.css" rel="stylesheet">
    <script src=
    "https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src=
    "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="bootstrap-dialog.js"></script>
    <script src="js/rtb4free.js"></script>
    <style type="text/css">
.bs-example{
        margin: 20px;
    }
    
    .form-signin
{
    max-width: 330px;
    padding: 15px;
    margin: 0 auto;
}
.form-signin .form-signin-heading, .form-signin .checkbox
{
    margin-bottom: 10px;
}
.form-signin .checkbox
{
    font-weight: normal;
}
.form-signin .form-control
{
    position: relative;
    font-size: 16px;
    height: auto;
    padding: 10px;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}
.form-signin .form-control:focus
{
    z-index: 2;
}
.form-signin input[type="text"]
{
    margin-bottom: -1px;
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
}
.form-signin input[type="password"]
{
    margin-bottom: 10px;
    border-top-left-radius: 0;
    border-top-right-radius: 0;
}
.account-wall
{
    margin-top: 20px;
    padding: 40px 0px 20px 0px;
    background-color: #f7f7f7;
    -moz-box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
    -webkit-box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
    box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
}
.login-title
{
    color: #555;
    font-size: 18px;
    font-weight: 400;
    display: block;
}
.profile-img
{
    width: 96px;
    height: 96px;
    margin: 0 auto 10px;
    display: block;
    -moz-border-radius: 50%;
    -webkit-border-radius: 50%;
    border-radius: 50%;
}
.need-help
{
    margin-top: 10px;
}
.new-account
{
    display: block;
    margin-top: 10px;
}

    </style>
</head>

<body>


 <div class="container">
 
    <div class="row" id="login">
        <div class="col-sm-6 col-md-4 col-md-offset-4">
            <h1 class="text-center login-title">Sign in to Monitor RTB4FREE</h1>
            <div >
                <form class="form">
                <input type="text" class="form-control" placeholder="Email" required autofocus id="username" value='demo'>
                <input type="password" class="form-control" placeholder="Password" required id="password" value='dordemonobigdeal'>
                <input type="button" class="btn btn-primary btnSeccion" onclick="doFormLogin();" value="Sign In"></button>
                </form>
            </div>

<script type="text/javascript">

function toggle(elementId) {
	var ele = document.getElementById(elementId);
	if(ele.style.display == "block") {
    		ele.style.display = "none";
  	}
	else {
		ele.style.display = "block";
	}
} 

</script>

        </div>
    </div>
</div>

 <div class="bs-example" style="display:none" id="bs-example">
           
  <div class="panel panel-primary">
   <div class="panel-heading">
      <h3 class="panel-title">RTB4FREE System Administration Page
      <a id='savechanges' href="#" onclick="saveChanges(); return false;" class="btn btn-success btn-sm"><i class="icon-white icon-heart"></i>Save Changes</a>
      		<a href="#" onclick="revert()" class="btn btn-info btn-sm"><i class="icon-white icon-heart"></i>Revert</a>
      	<a href="admin" class="btn btn-danger btn-sm"><i class="icon-white icon-heart"></i>Logout</a></h3>
   </div>
   <div class="panel-body">

        
        <p>This page is used to manage the operational RTB4FREE Bidder Farm</p>

</div>


   
            


        <ul class="nav nav-tabs" id="myTab">

            <li >
                <a data-toggle="tab" href="#users" onclick="setPaneOptions('users');">Users</a>
            </li>
            <li>
                <a data-toggle="tab" href="#configuration" onclick="setPaneOptions('config');">Configuration</a>
            </li>

            <li>
                <a data-toggle="tab" href="#status" onclick="setPaneOptions('status');">System Status</a>
            </li>
        </ul>

        <div class="tab-content" id="myTabContent">
        
       
        
            <div class="tab-pane fade" id="users">
            
            
            <div class="panel panel-success">
   <div class="panel-heading">
      <h3 class="panel-title">Current Users</h3>
   </div>
   <div class="panel-body">
   
   <table id="addusers">
   <tr>
   <th>Name</th>
   <th>Password</th>
   <th>Directory</id>
   <th>Phone</th>
   <th>E-Mail</th>
   <th>Credit Card</th>
     <tr id="row0">
                        <td><input id="p_new_forward_url" name="p_new_x"
                        placeholder="Name" size="30" type="text" value=
                        ""></td>

                        <td><input id="p_new_image_url" name="p_new"
                        placeholder="Password" size="20" type="text" value=
                        ""></td>

                        <td><input id="p_new_impid" name="p_new" placeholder=
                        "Id" size="20" type="text" value=""></td>
                        
                        <td><input id="p_new_impid" name="p_new" placeholder=
                        "Phone" size="20" type="text" value=""></td>   
                        
                        <td><input id="p_new_impid" name="p_new" placeholder=
                        "Email" size="20" type="text" value=""></td>      
                        
                                  
                        <td><input id="p_new_impid" name="p_new" placeholder=
                        "Credit Authorization" size="20" type="text" value=""></td>      
                        <td>
                            <a href="javascript:doDynoSeats();">Add</a>
                        </td>
                    </tr>
   </table>
   
 </div>
</div>

   
            </div>

            <div class="tab-pane fade" id="configuration">


<div class="panel panel-success">
   <div class="panel-heading">
      <h3 class="panel-title">Seats</h3>
   </div>
   <div class="panel-body">
   
   <table id="addseats">
   <tr>
   <th>Name</th>
   <th>Id</id>
   <th>Bid Endpoint</th>
   </tr>
    <tr id="row0">
                        <td><input id="p_new_forward_url" name="p_new_x"
                        placeholder="Name" size="50" type="text" value=
                        ""></td>

                        <td><input id="p_new_image_url" name="p_new"
                        placeholder="Id" size="10" type="text" value=
                        ""></td>

                        <td><input id="p_new_impid" name="p_new" placeholder=
                        "Bid Endpoint" size="50" type="text" value=""></td>

                        <td>
                            <a href="javascript:doDynoSeats();">Add</a>
                        </td>
                    </tr>
   </table>
   
 </div>
</div>

<div class="panel panel-success">
   <div class="panel-heading">
      <h3 class="panel-title">Application</h3>
   </div>
   <div class="panel-body">
   
   
   <div class="panel panel-info">
   <div class="panel-heading">
      <h3 class="panel-title">Logging</h3>
   </div>
   <div class="panel-body">
    <table>
   
   <tr>
   <td>Verbosity</td>
   <td><select class="selectpicker">
    <option>5</option>
    <option>4</option>
    <option>3</option>
    <option>2</option>
    <option>1</option>
    <option>-1</option>
    <option>-2</option>
    <option>-3</option>
    <option>-4</option>
    <option selected>-5</option>
  </select></td>
   </tr>
   
   <tr>
      <td>No Bid Reason&nbsp;</td>
   <td><select class="selectpicker">
    <option selected>true</option>
    <option>false</option>
  </select></td></td>
   </tr>
   
   
   </table>
 </div>
 
 
 <div class="panel panel-info">
   <div class="panel-heading">
      <h3 class="panel-title">Geotags</h3>
   </div>
   <div class="panel-body">
 </div>
</div>
 
 
 <div class="panel panel-info">
   <div class="panel-heading">
      <h3 class="panel-title">Redis</h3>
   </div>
   <div class="panel-body">
   
   <table>
   
   <tr>
   <td>Hostname</td>
   <td><input id="redis_host" name="p_new" placeholder=
                        "Host" size="32" type="text" value="locallhost"></td>
   </tr>
   
   <tr>
      <td>Port</td>
   <td><input id="redis_host" name="p_new" placeholder=
                        "Host" size="32" type="text" value="6379"></td>
   </tr>
   
   <tr>
      <td>Win Channel</td>
   <td><input id="redis_host" name="p_new" placeholder=
                        "Host" size="32" type="text" value="wins"></td>
   </tr>
   
      <tr>
      <td>Bid Channel</td>
   <td><input id="redis_host" name="p_new" placeholder=
                        "Host" size="32" type="text" value="bids"></td>
   </tr>
   
      <tr>
      <td>Requests Channel&nbsp;</td>
   <td><input id="redis_host" name="p_new" placeholder=
                        "Host" size="32" type="text" value="requests"></td>
   </tr>
   
   
      <tr>
      <td>Clicks Channel &nbsp;</td>
   <td><input id="redis_host" name="p_new" placeholder=
                        "Host" size="32" type="text" value="clicks"></td>
   </tr>
   <tr>
      <td>Logger Channel</td>
   <td><input id="redis_host" name="p_new" placeholder=
                        "Host" size="32" type="text" value="log"></td>
   </tr>
   
   
   </table>
   
 </div>
</div>
 
<div class="panel panel-info">
   <div class="panel-heading">
      <h3 class="panel-title">Initial Campaigns</h3>
   </div>
   <div class="panel-body">
    <table id="addinititalloads">
   <tr>
   <th>Campaign Owner Name</th>
   <th>Campaign Ad Id</id>
   </tr>
    <tr id="row0">
                        <td><input id="p_new_forward_url" name="p_new_x"
                        placeholder="Name" size="50" type="text" value=
                        ""></td>

                        <td><input id="p_new_image_url" name="p_new"
                        placeholder="Id" size="30" type="text" value=
                        ""></td>

                            <a href="javascript:doDynoInitLoadCells();">Add</a>
                        </td>
                    </tr>
   </table>
 </div>
</div>
 
</div>
   
   
   
   
   
   
   
 </div>
</div>


            </div>

            <div class="tab-pane fade" id="status">
                Network status:
                <table id='system-status'>
                <tr>
                <th>Name</th>
                <th>Total</th>
                <th>Bid</th>
                <th>Nobid</th>
                <th>Win</th>
                <th>Pixel</th>
                <th>Click</th>
                <th>Errors</th>
                <th>%Bid</th>
                <th>%Win</th>
                <th>%Pixel</th>
                <th>%Click</th>
                <th>Ad Spend</th>
                <th>QPS</th>
                <th>X-time(avg)</th>
                </tr>
                </table>
                
                <hr/>
                Operational Status:
                <table id='operstatus'>
                <tr>
                	<th>Name</th>
                	<th>Running</th>
                	<th>Campaigns</th>
                	<th>Log Level</th>
                	<th>Show No Bid Reason</th>
                	<th>Select</th>
                </tr>
                </table>
                <br/>
                Commands:
                <br/>
                <button type="button" class="btn btn-danger" id='stop-bidder' onclick='doStopBidder()'>Stop Bidder</button>
                <button type="button" class="btn btn-success" id='start-bidder' onclick='doStartBidder()'>Start Bidder</button>
                <button type="button" class="btn btn-warning" id='changeloglevel-bidder' onclick='doChangeLog()'>Change Log Level</button>
                <button type="button" class="btn btn-success" id='changenobidreason-bidder' onclick='doChangeNoBidReason()'>Change No Bid Reason</button>
                <button type="button" class="btn btn-danger" id='reload-bidder' onclick='doReloadBidder()'>Reload Campaigns</button>
                <br>
                <br/>
                
                  <input type="button" class="btn btn-primary btnSeccion" onclick="reloadStatus();" value="Refresh"></button>
                
                <hr/>
                <i><b>System Console</i></b>
                <table id="logger" border="0" cellpadding="0" cellspacing="0" width="100%" class="scrollTable"/>
<thead>
<tr>
<th>Date</th>
<th>Sev</th>
<th>From</th>
<th>Source</th>
<th>Message</th>
</tr>
</thead>
<tbody class="scrollContent">
</tbody>
</table>

            </div>
            
                     
        </div>
                      
    </div>
    
          <footer>
        <p>&copy; Ben M. Faul, Peter Loh, RTB4FREE.ORG 2015<br/>Email: Ben.Faul@gmail.com</p>
      </footer>   
      
    </div>
    </div>
</body>
<script>

function revert() {
	usersDyno.clear();
	seatsDyno.clear();
	initLoadsDyno.clear();
	reloadStatus();
	doFormLogin();
}

function doFormLogin() {
	userName = document.getElementById("username").value;
	var password = document.getElementById("password").value;
	console.log("U="+userName+", P="+password);
	
	//setTimeout(function(){window.location.href='campaign'},0);
	
	  msg = {};
	  msg.command = "loginAdmin";
	  msg.username = userName;
	  msg.password = password;
	  ////////////////////
        $.ajax({
         type: 'POST',
         url:'ajax',
         data: JSON.stringify(msg),
         dataType: 'json',
         success: function(data, textStatus, request){
           if (request.status == 204) {
            text = "";
           } else {
            text = request.responseText;
            data = JSON.parse(text);
            message = data.message;
            text = JSON.stringify(data,null,2);
            console.log("-----------------");
            console.log(text);
           }
           if (data.error) {
           		doModal(BootstrapDialog.TYPE_DANGER,"Error","Error logging in");
           		return;
           }
           else {
           
           	
				if (userName === 'demo')
					setDemoButtons();
           
				var ele = document.getElementById("login");
				ele.style.display = "none";
	
				ele = document.getElementById("bs-example");
				ele.style.display = "block";
	
		   		clearFields();
				fillInStatus(data);

				fillInUsers(data);
				
				fillInSeats(data);
	   			
	   			fillInInits(data);
	   			
	   			fillInOperStatus(data);
	
	   		}

         },
         error: function (request, textStatus, errorThrown) {
           doModal(BootstrapDialog.TYPE_INFO,"Error",request.responseText);
         }});
    ////////////////////
}

function fillInUsers(data) {
	var users = data.users;
	for (var i=0; i<users.length;i++) {
		var user = users[i];
		usersDyno.add([user.name,user.password,user.directory,user.phone,user.email,user.creditcard,'']);
	}
		
}

function fillInSeats(data) {
	var seats = data.seats;
	for (var i=0; i<seats.length;i++) {
		var seat = seats[i];
		seatsDyno.add([seat.name,seat.id,seat.bid,'']);
	}
}

function fillInInits(data) {
	var inits = data.initials;
	for (var i=0; i<inits.length;i++) {
		var camp = inits[i];
		initLoadsDyno.add([camp.name,camp.id,'']);
	}
}

function fillInOperStatus(data) {
	operDyno.clear();
	var summaries = data.summaries;
	for (var i=0; i<summaries.length;i++) {
		var summary = summaries[i];
		operDyno.add([summary.name,!summary.values.stopped,summary.values.ncampaigns,summary.values.loglevel,summary.values.nobidreason,'']);
	}
}

function fillInStatus(data) {
			var status = data.status;
	   			var total = 0, bid = 0, nobid = 0, win = 0, clicks = 0, pixels = 0, errors = 0, 
	   					percBid = 0, percWin, percPixel, percClick, spend = 0, total_qps = 0;
	   		    var d = new Date();
				var now = d.getMilliseconds();
				var qps = 0;
	   			
	   			for (var i=0; i<status.length;i++) {
	   				  var e = status[i];
	   				  var v = e.values;
	   				  var pbid = 0, pwin = 0;
	   				  if (v.bid + v.nobid != 0)
	   				  	pbid = Number( 100 * v.bid/(v.bid + v.nobid)).toFixed(2);
	   				  if (v.bid != 0)
	   				  	pwin = Number( 100 * v.win/v.bid).toFixed(2);
	   				  if (v.win == 0)
	   				  	ppix = 0;
	   				  else
	   				  	ppix = Number(100 * v.pixels/v.win).toFixed(6);
	   				  if (v.pixels == 0)
	   				  	pclc = Number(0).toFixed(6);
	   				  else
	   				    pclc = Number( 100 * v.clicks/v.win).toFixed(6);
	   				  var spnd = Number(v.adspend).toFixed(6);
	   				  sqps = Number(v.qps).toFixed(6);
	   				  systemDyno.add([e.name, v.total,v.bid,v.nobid,v.win,v.pixels,v.clicks,v.errors,pbid,pwin,ppix,pclc,spnd,sqps,Number(v.avgx).toFixed(6)]);
	   				  total += v.total;
	   				  bid += v.bid;
	   				  nobid += v.nobid;
	   				  win += v.win;
	   				  clicks += v.clicks;
	   				  pixels += v.pixels;
	   				  errors += v.errors;
	   				  spend += v.adspend;
	   				  total_qps += v.qps;		  
	   			}
	   			percPix = percClc  = percWin = percBid = 0;
	   			if (bid+nobid != 0)
	   				percBid = Number(100 * bid/(bid+nobid)).toFixed(2);
	   			if (bid != 0)
	   				percWin = Number(100 * win/bid).toFixed(2);
	   			if (win != 0) { 		
	   				percPix = Number(100 * pixels/win).toFixed(6);
	   				percClc = Number(100 * clicks/win).toFixed(6);
	   			}
	   			if (lastTime != 0) 
	   				sqps = Number(total_qps).toFixed(6);
	   			else
	   				sqps = "...";
	   			percClc = Number(percClc).toFixed(6);
	   			lastTime = now;
	   			spend = Number(spend).toFixed(6);
	   			sqps = Number(total_qps).toFixed(6);
	   			systemDyno.add(['', '','','','','','','','','','','','','','']);
	   			systemDyno.add(['Total', total,bid,nobid,win,pixels,clicks,errors,percBid,percWin,percPix, percClc,spend, sqps,'na']);
	   			
			}

function reloadStatus() {

	  msg = {};
	  msg.command = "loginAdmin";
	  msg.username = userName;
	  msg.password = document.getElementById("password").value;
	  ////////////////////
        $.ajax({
         type: 'POST',
         url:'ajax',
         data: JSON.stringify(msg),
         dataType: 'json',
         success: function(data, textStatus, request){
           if (request.status == 204) {
            text = "";
           } else {
            text = request.responseText;
            data = JSON.parse(text);
            message = data.message;
            text = JSON.stringify(data,null,2);
            console.log("-----------------");
            console.log(text);
           }
           if (data.error) {
           		doModal(BootstrapDialog.TYPE_DANGER,"Error","Error logging in");
           		return;
           }
           else {
	   		
	   			systemDyno.clear();
	   		    fillInStatus(data);	
	   		    fillInOperStatus(data);
	   		
	   		}

         },
         error: function (request, textStatus, errorThrown) {
           doModal(BootstrapDialog.TYPE_INFO,"Error",request.responseText);
         }});
    ////////////////////
}



function clearFields() {

}
           
    function deleteSeats() {
    
    }
    
    function doDynoSeats() {
    
    }
   
   function doStopBidder() {
   BootstrapDialog.show({
    		icon: 'glyphicon glyphicon-send',
   			type: BootstrapDialog.TYPE_DANGER,
   			title: 'DANGER',
            message: 'You are about to stop the running bidders!',
            autospin: true,
            buttons: [
            {
                label: 'Proceed?',
                cssClass: 'btn-danger',
                action: function(dialogRef) {
                    dialogRef.enableButtons(false);
                    dialogRef.setClosable(false)
                	executeBidderCommand(userName,"stop","*",null);
                	setTimeout(function(){
                        dialogRef.close();
                        reloadStatus();
                    }, 5000);
                }
            }, {
                label: 'Close',
                action: function(dialogItself){
                    dialogItself.close();
                }
            }]
        });
   }
   
   function executeBidderCommand(userName,action,who,level) {
      msg = {};
	  msg.command = "executeCommand";
	  msg.username = userName;
	  msg.action = action;
	  msg.who = "*";
	  msg.level = level;
	  ////////////////////
        $.ajax({
         type: 'POST',
         url:'ajax',
         data: JSON.stringify(msg),
         dataType: 'json',
         success: function(data, textStatus, request){
           if (request.status == 204) {
            text = "";
           } else {
            text = request.responseText;
            data = JSON.parse(text);
            message = data.message;
            text = JSON.stringify(data,null,2);
            console.log("-----------------");
            console.log(text);
           }
           if (data.error) {
           		doModal(BootstrapDialog.TYPE_DANGER,"Error", message);
           		return;
           }
			
				console.log("OK STOPPED");

         },
         error: function (request, textStatus, errorThrown) {
           doModal(BootstrapDialog.TYPE_INFO,"Error",request.responseText);
         }});
    ////////////////////
   
   		console.log("-------------------> Stop");
   }
   
   function doStartBidder() {
   BootstrapDialog.show({
   			type: BootstrapDialog.TYPE_INFO,
   			title: 'INFO',
            message: 'You are about to start the selected bidders!',
            buttons: [
            {
                label: 'Proceed?',
                cssClass: 'btn-success',
                action: function(dialogRef) {
   					dialogRef.enableButtons(false);
                    dialogRef.setClosable(false)
                	executeBidderCommand(userName,"start","*",null);
                	setTimeout(function(){
                        dialogRef.close();
                        reloadStatus();
                    }, 5000);
                }
            }, {
                label: 'Close',
                action: function(dialogItself){
                    dialogItself.close();
                }
            }]
        });
   }
   
   function executeStartBidders() {
   		console.log("-------------------> START");
   }
   
    function doChangeLog() {
  	 	BootstrapDialog.show({
   			type: BootstrapDialog.TYPE_WARNING,
   			title: 'WARNING',
            message: function(dialogItself) {
				var $form = $('<form></form>');
        		//var $titleDrop = $('<input type="text" id="newlevel" />');
        		
        		var $titleDrop = "<select id='newlevel'>" +
  									"<option value='-5'>-5</option>" +
  									"<option value='-4'>-4</option>" +
  									"<option value='-3'>-3</option>" +
  									"<option value='-2'>-2</option>" +
  									"<option value='-1'>-1</option>" +
  									"<option value='1'>1</option>" +
  									"<option value='2'>2</option>" +
  									"<option value='3' selected>3</option>" +
  									"<option value='4'>4</option>" +
  								    "<option value='5'>5</option>" +
									"</select>";
        		
        		dialogItself.setData('field-title-drop', $titleDrop);   // Put it in dialog data's container then you can get it easier by using dialog.getData() later.
        		$form.append('You are about to change log levels<br/><label>New log level (-5 to 5)&nbsp; </label>').append($titleDrop);

        		return $form;
            },
          //  message: 'You are about to change the logging level of the selected bidders!',
            buttons: [
            {
                label: 'Proceed?',
                cssClass: 'btn-warning',
                action: function(dialogRef) {
   					dialogRef.enableButtons(false);
                    dialogRef.setClosable(false)
                    obj = document.getElementById("newlevel");
                    var value = obj.value
                	executeBidderCommand(userName,"loglevel","*",value);
                	setTimeout(function(){
                        dialogRef.close();
                        reloadStatus();
                    }, 5000);
                }
            }, {
                label: 'Close',
                action: function(dialogItself){
                    dialogItself.close();
                }
            }]
        });
   }
   
     function doChangeNoBidReason() {
  	 	BootstrapDialog.show({
   			type: BootstrapDialog.TYPE_WARNING,
   			title: 'WARNING',
            message: function(dialogItself) {
				var $form = $('<form></form>');
        		//var $titleDrop = $('<input type="text" id="newlevel" />');
        		
        		var $titleDrop = "<select id='newlevel'>" +
  									"<option value='false'>false</option>" +
  									"<option value='true'>true</option>"
									"</select>";
        		
        		dialogItself.setData('field-title-drop', $titleDrop);   // Put it in dialog data's container then you can get it easier by using dialog.getData() later.
        		$form.append('You are about to change change the print no bid reason flag<br/><label>Print: &nbsp; </label>').append($titleDrop);

        		return $form;
            },
          //  message: 'You are about to change the logging level of the selected bidders!',
            buttons: [
            {
                label: 'Proceed?',
                cssClass: 'btn-warning',
                action: function(dialogRef) {
   					dialogRef.enableButtons(false);
                    dialogRef.setClosable(false)
                    obj = document.getElementById("newlevel");
                    var value = obj.value
                	executeBidderCommand(userName,"nobidreason","*",value);
                	setTimeout(function(){
                        dialogRef.close();
                        reloadStatus();
                    }, 5000);
                }
            }, {
                label: 'Close',
                action: function(dialogItself){
                    dialogItself.close();
                }
            }]
        });
   }
   
   function doReloadBidder() {
   BootstrapDialog.show({
   			type: BootstrapDialog.TYPE_DANGER,
   			title: 'DANGER',
            message: 'You are about to reload all the campaigns of the selected bidders!',
            buttons: [
            {
                label: 'Proceed?',
                cssClass: 'btn-danger',
                action: function(dialogItself) {
                	executeReloadBidders();
                	dialogItself.close();
                }
            }, {
                label: 'Close',
                action: function(dialogItself){
                    dialogItself.close();
                }
            }]
        });
   }
   
   function setDemoButtons() {
     	$('#savechanges').addClass('disabled');
     	$('#start-bidder').addClass('disabled');
     	$('#stop-bidder').addClass('disabled');
     	$('#start-bidder').addClass('disabled');
     	$('#reload-bidder').addClass('disabled');
     	$('#changeloglevel').addClass('disabled');
   }
   
   function setPaneOptions(panel) {
   		pane = panel;
   		
   		if (userName === 'demo')
   			return;
   			
   		if (panel === 'status' || status === 'configuration') {
   		   	$('#savechanges').addClass('disabled');
   		} else {
   		    $('#savechanges').removeClass('disabled');
   		}
   }
   
   function saveChanges() {
   	    alert("Save changes for: " + pane);
   	}
   
   function executeReloadBidders() {
   		console.log("-------------------> ChangeLog");
   }
          
 seatCells = []
    seatCells.push("<input type='text' id='SUB_ID' size='50' value='' placeholder='Name' />");
    seatCells.push("<input type='text' id='SUB_ID' size='10' value='' placeholder='Endpoint' />");
    seatCells.push("<input type='text' id='SUB_ID' size='50' value='' placeholder='Id' />")
    seatCells.push("<a href=\"javascript:deleteSeat('ROW_ID');\">Del<\/a><\/td>");
    seatsDyno = new DynamicTable("addseats",seatCells);
    
    
 userCells = []
    userCells.push("<input type='text' id='SUB_ID' size='30' value='' placeholder='Name' />");
    userCells.push("<input type='text' id='SUB_ID' size='20' value='' placeholder='Password' />")
    userCells.push("<input type='text' id='SUB_ID' size='20' value='' placeholder='Directory' />");
    userCells.push("<input type='text' id='SUB_ID' size='20' value='' placeholder='Phone-Number' />");
    userCells.push("<input type='text' id='SUB_ID' size='20' value='' placeholder='Email' />");
    userCells.push("<input type='text' id='SUB_ID' size='20' value='' placeholder='Credit-Card' />");
    userCells.push("<a href=\"javascript:deleteUser('ROW_ID');\">Del<\/a><\/td>");
    usersDyno = new DynamicTable("addusers",userCells);
    
 systemCells = [];
 	systemCells.push("<input type='text' id='SUB_ID' size='30' readonly value=''/>");
 	systemCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	systemCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	systemCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	systemCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	systemCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	systemCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	systemCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	systemCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	systemCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	systemCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	systemCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	systemCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	systemCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	systemCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	systemDyno = new DynamicTable("system-status",systemCells);
 	
operCells = [];
 	operCells.push("<input type='text' id='SUB_ID' size='30' readonly value=''/>");
 	operCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	operCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	operCells.push("<input type='text' id='SUB_ID' size='8'  readonly value=''/>");
 	operCells.push("<input type='text' id='SUB_ID' size='18'  readonly value=''/>");
 	operCells.push("<input type='checkbox' id=SUB_ID'  value='' checked/>");
 	operDyno = new DynamicTable("operstatus",operCells);

initLoadCells = []
    initLoadCells.push("<input type='text' id='SUB_ID' size='50' value='' placeholder='Name' />");
    initLoadCells.push("<input type='text' id='SUB_ID' size='30' value='' placeholder='Id' />");
    initLoadsDyno = new DynamicTable("addinititalloads",initLoadCells);
    
	lastTime = 0;
	
	
   logger = new Logger('logger','log',"localhost:7379");
	
	pane = null;		// current campaign
	
	userName = null;    // no user yet
	
	doModal(BootstrapDialog.TYPE_INFO,"Info","You are logging in as 'demo', just press 'Sign In' to go to\nproceed to the campaign admin page");
 
	
 </script>

</html>