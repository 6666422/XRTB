<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta content="Details how to build and operate the RTB bidding engine."
    name="description">
    <meta content="RTB,OpenRTB,JAVA,Advertising,real-time" name="keywords">
    <meta content="RTB4FREE" name="author">

    <title>RTB Private Exchange Details</title><!-- Latest compiled and minified CSS -->
    <link href=
    "http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel=
    "stylesheet"><!-- jQuery library -->

    <script src=
    "https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script><!-- Latest compiled JavaScript -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-5532985-4', 'auto');
  ga('send', 'pageview');

</script>
</head>

<body>
    <nav class="navbar navbar-fixed-top navbar-inverse">
        <div class="container">
            <div class="navbar-header">
                <button class="navbar-toggle collapsed" data-target="#navbar"
                data-toggle="collapse" type="button"><span class=
                "sr-only">Toggle navigation</span> <span class=
                "icon-bar"></span> <span class="icon-bar"></span> <span class=
                "icon-bar"></span></button> <a class="navbar-brand" href=
                "#">RTB For Free!</a>
            </div>

            <div class="collapse navbar-collapse" id="navbar">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="x_index.html">Home</a>
                    </li>

                    <li>
                        <a href="x_about.html">About</a>
                    </li>

                    <li>
                        <a href="x_contact.html">Contact</a>
                    </li>
                </ul>
            </div><!-- /.nav-collapse -->
        </div><!-- /.container -->
    </nav><!-- /.navbar -->
    <br>
    <br>
    <br>
    <br>

    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h1>RTB Private Exchange</h1><i>(NOTE: THIS IS A WORK IN
                PROGRESS)</i><br>

                <p>A RTB Private Exchange written in Java
                1.8</p>The Private Exchange project contains 3 major components:

                <ul>
                    <li>RTB private Exchange</li>

                    <li>Sample web page demonstrating the concepts</li>

                    <li>Administration system for web-page campaign definition</li>
                </ul>

                <p>This project is for those fairly familiar with RTB. With a
                basic understanding of RTB, this project will get you up and
                running with a stand-alone RTB based private exchange. Though not
                intended to be a production auction platform, the concepts this exchange
                uses is similar to those encountered in a production system.</p>
                <p>This system uses a simple shared JAVA HashMap objects as the
                database of campaigns to associate with advertisements, which is
                based on the the Redisson system. A commercial auction system would
                of course us a real DBMS for this.</p>
                <p>This section of the RTB4FREE web site steps you through all
                the steps required in setting up a campaign on a web page, and then how to point
                your own mobile browser to the sample web page to fire the ad request to the
                Private Exchange, send the bid request to the RTB4FREE bidder, then receive the
                advertisement back and displayed in your broswer.</p>
                <p>The sample advertisement will use your GEO location to send you
                an appropriate bid</p>
                <p>

                <ul>
                    <li>
                        <a href="#BUILD">Building the System</a>
                    </li>

                    <li>
                        <a href="#CONFIGURATION">Configuring and Running the
                        System</a>
                    </li>

                    <li>
                        <a href="#RUNNING">Running System</a>
                    </li>

                    <li>
                        <a href="#ANATOMY-BANNER">Anatomy of a Banner Advertisement</a>
                    </li>
					 <li>
                        <a href="#ANATOMY-VIDEO">Anatomy of a Video Advertisement</a>
                    </li>
                    <li>
                        <a href="#THEORY">Theory of Operation</a>
                    </li>

                    <li>
                        <a href="#REDIS">REDIS Commands</a>
                    </li>

                    <li>
                        <a href="#DEPENDENCIES">Dependencies</a>
                    </li>
                </ul>

                <nav>
                    <ul class="pager">
                        <li>
                            <a href="arch/RTB_architecture_mod3.html" target=
                            "_blank">Architecture Slides</a>
                        </li>

                        <li>
                            <a href="javadoc/index.html" target=
                            "_blank">Javadoc Pages</a>
                        </li>

                        <li>
                            <a href="html/index.html" target="_blank">Junit
                            Reports</a>
                        </li>
                    </ul>
                </nav>
                <hr>
                <a id="BUILD" name="BUILD"></a>

                <h1>BUILDING THE SYSTEM</h1>

                <p>You will need ANT, JAVA 1.8, and REDIS installed to build
                the system. The dependent libraries required are already placed
                in the ./libs directory</p>If you use Eclipse or some other
                IDE, make your project includes the ./libs directory.
                <p>

                <p>Note, there is a stub .gitignore file included, (named gitignore, rename it to .gitignore).</p>

                <p>Now use ant to build the system:</p>$ant

                <p>----&gt; Will create ./libs/privatex.jar -- Which is the jar
                file of the private excgabfe project.</p>

                <p>$ant javadoc</p>

                <p>----&gt; Will create <a href="javadoc/index.html" target=
                "_blank">javadoc</a> documents in the ./javadoc directory.</p>

                <p>$ant junitreport</p>

                <p>----&gt; Will run the <a href="html/index.html" target=
                "_blank">JUNIT</a> test cases and output the reports in the
                ./reports directory</p><a id="CONFIGURATION" name=
                "CONFIGURATION"></a>

                <h1>Running the Private Exchange</h1>

                <p>In order to run the private exchange you first have to load an
                initial database of campaigns into Redis, then construct a configuration
                file for use on startup, and then you can actually start the
                private exchange. The steps below will accomplish these tasks</p>

                <h2>Creating Initial Database as JSON File</h2>

                <p>Before you can use the private exchange, the RTB4FREE Private
                Exchange has to be configured. The first thing to configure is the web-page
                campaign database, which is actually a JAVA ConcurrentHashMap, that is
                shared across all the private exchange instance (regardless of what host they are
                on) as a Redisson object. Redisson provides the shared context
                among all the private exchange instances. Redisson uses the REDIS key/value store.
                By using Redisson, RTB4FREE can share the User/Web-Campaign
                database simply by instantiating the Map and using it as
                normal. Private Exchange Instance A makes a change, Private Exchange Instance B can immediately see
                the changes</p>

                <p>There are multiple records of the User object in the Map.
                The User object is simple object with the name, a time stamp,
                and a List of Campaign records. The initial Redisson database
                is loaded from file using the DbTools program. A sample first
                database is provided as ./database.json Simply run the DBTools
                program and this initial database will be stored in Redis for
                you. From there you can easily run the rest of the system. The
                database.hson file has one user "ben", and "ben" has 1
                campaign, which matches the web campaign used as the sample ad page
                for the demonstration of this system. Each web page has a user/web-campaign record. 
                The contents of ./web-campaigns.json can be viewed
                <a href="javascript:toggle('databaseJSON');" id=
                "display1">here.</a></p>


                <div onclick="javascript:toggle('databaseJSON');">
                    <div id="databaseJSON" style=
                    "display:none; border-width:2px; border-style:solid">
<pre>
<code>
{
    "publishers": {
        "111-222-33-444-555": {
            "name": "Really Big Corp.",
            "address": "the-address",
            "telephoneNumber": "tel-number",
            "id": "publisher-id",
            "domain":"junk1.com",
            "campaigns": {
                "banner-campaign": {
                    "price": 10,
                    "served": 0,
                    "requested": 0,
                    "page": "http://www.rtb4free/sample.html",
                    "attributes": [
                        "var Impression = Java.type('com.xrtb.privatex.bidrequest.Impression');",
                        "im = new Impression().doBanner();",
                        "im.id = request.id;",
                        "im.instl = 0;",
                        "im.banner.setHeight(50);",
                        "im.banner.setWidth(320);",
                        "im.banner.setPos(0);",
                        "request.imp.add(im);",
                        "request.device.ua =  cmd.ua;",
                        "request.device.geo.lat = cmd.lat;",
                        "request.device.geo.lon = cmd.lon;",
                        "request.site.cat.add('IAB1');",
                        "request.site.cat.add('IAB2');",
                        "request.site.ext.rtb4free.platform=cmd.platform;",
                        "request.site.ext.rtb4free.connectionType=cmd.connectionType;",
                        "request.site.ext.rtb4free.maxDownLink=cmd.maxDownLink;"
                    ]
                },
                "video-campaign": {
                    "price": 12,
                    "served": 0,
                    "requested": 0,
                    "page": "http://www.rtb4free/video-sample.html",
                    "attributes": [
                        "var Impression = Java.type('com.xrtb.privatex.bidrequest.Impression');",
                        "im = new Impression().doVideo();",
                        "im.id = request.id;",
                        "im.instl = 0;",
                        "im.video.setWidth(400);",
                        "im.video.setHeight(200);",
                        "im.video.setLinearity(1);",
                        "im.video.setMinduration(5);",
                        "im.video.setMaxduration(30);",
                        "im.video.setPos(0);",
                        "im.video.addMime('video/x-flv');",
                        "im.video.addMime('application/x-shockwave-flash');",
                        "im.video.setProtocol(2);",
                        "request.imp.add(im);",
                        "request.device.ua =  cmd.ua;",
                        "request.device.geo.lat = cmd.lat;",
                        "request.device.geo.lon = cmd.lon;",
                        "request.site.cat.add('IAB1');",
                        "request.site.cat.add('IAB2');",
                        "request.site.ext.rtb4free.platform=cmd.platform;",
                        "request.site.ext.rtb4free.connectionType=cmd.connectionType;",
                        "request.site.ext.rtb4free.maxDownLink=cmd.maxDownLink;"
                    ]
                }
                
            }
        }
    },
    "subscribers": [
        {
            "name": "the-name",
            "address": "the-address",
            "telephoneNumber": "tel-number",
            "accountNumber": "account-number",
            "url": "http://localhost:8080/rtb/bids/nexage",
            "maxConnections": 100,
            "maxRate": 1000
        }
    ]
}
</code>
</pre>         
                </div>
                </div>
                <p>

                <h2>Load Initial Database File into Redis(son)</h2>

                <p>With the initial database.json ready, we will now load the
                database.json into Redisson. Simoly run the following ant
                command:</p>
                <pre>
    $ant load-database
</pre>This will load database.json from the current directory into the Redis
system running on a host. To change the parameters of DbTools, look at the
JAVADOC for <a href="privatex/javadoc/tools/DbTools.html" style="font-style: italic"
                target="_blank">com.xrtb.privatex.cfg.Database.java</a> for details on how to
                use the DbTools program.
                <p>

                <p>The database in Redis is where all the User/Web-Campaign records
                are stored, but, then to run these campaigns, you must tell the
                Private Exchanges to pull these web campaigns into their local memory (using
                a Redis command). The database in Redis is the static location
                for the Users and their Campaigns. To 'run' a campaign' you
                load it into the bidders local memory. All the bidders have a
                ConcurrentHashMap that comprises this database, and it is
                shared across all the bidders.</p>

                <p>In a commercial setting, you would likely replace this
                shared hashmap/Database part of Private Exchange with your own database management
                system.</p>
                There is a sample initialization file called
                "./config.json' you can use to get started. The file
                describes the operational parameters of the private exchange. If
                you want to see the sample configuration, click here: <a href=
                "javascript:toggle('toggleText');" id=
                "displayText">./config.json</a></p>

                <div onclick="javascript:toggle('toggleText');">
                    <div id="toggleText" style=
                    "display:none; border-width:2px; border-style:solid">
<pre>
<code>
{
    "instance": "this-systems-instance-name-here",
    "port": 9090,
    "app": {
        "connections": 100,
        "ttl": 300,
        "verbosity": {
            "level": -5,
            "nobidReason": true
        },
        "redis": {
            "host": "localhost",
            "logger": "xlog",
            "port": 6379
        },
        "campaigns": [
            {
                "accountNumber": "111-222-333",
                "campaign": "TheSampleDemoCampaign"
            }
        ]
    },
    "web": [
        {
            "context": ["/h*"],
            "base": ".",
            "className": "HelloHandler"
        },
        {
            "context": ["/b*"],
            "base": ".",
            "className": "ByeHandler"
        }
    ]
}
</code>
</pre>
</div>
                </div>
                <p>The <i>publishers</i> object is an array of publishers (entities offering for sale space on a web page).</p>
                <p>The <i>subscribers</i> object is an array describing one or more RTB bidding engines that can connect to the private
                exchange and participate in auctions.</p>

                <h2>Configuring the Private Exchange</h2>
                <p>In order to run the private exchange, you will need to load a web-campaign
                into the private exchange's memory and setup some operational parameters.
                These parameters are stored in a JSON file the private exchange uses when
                it starts. The file is located here
  				
  				<a href=
                "javascript:toggle('toggleInstance');" id=
                "displayText">./config.json</a></p>

                <div onclick="javascript:toggle('toggleInstance');">
                    <div id="toggleInstance" style=
                    "display:none; border-width:2px; border-style:solid">
 <pre>
 <code>               
{
    "instance": "this-systems-instance-name-here",
    "port": 9090,
    "app": {
        "connections": 100,
        "ttl": 300,
        "verbosity": {
            "level": 2,
            "nobid-reason": true
        },
        "redis": {
            "host": "localhost",
            "logger": "xlog",
            "port": 6379
        },
        "campaigns": [
            {
                "accountNumber": "111-222-333",
                "campaign": "TheSampleDemoCampaign"
            }
        ]
    }
}
</code>
</pre>      
</div>      
</div>     
                <a id="RUNNING" name="RUNNING"></a>
                <h1>RUNNING THE PRIVATE EXCHANGE</h1>
                <p>Now that you have the Private Exchange configured and the database loaded into redisson you need to start the private exchange.
                Issue the following command:</p>
                <pre>
$ant privatex
                </pre>
                <p>The output of the ant command will show some initialization. To see what the startup looks like click 

				<a href=
                "javascript:toggle('toggleSTDOUT');" id=
                "displayText">here.</a></p>

                <div onclick="javascript:toggle('toggleSTDOUT');">
                    <div id="toggleSTDOUT" style=
                    "display:none; border-width:2px; border-style:solid">
               
<pre>
<code>                
Picked up JAVA_TOOL_OPTIONS: -javaagent:/usr/share/java/jayatanaag.jar 
Subscribers:
Subscribers:
[
  {
    "url": "http://localhost:8080/rtb/bids/nexage",
    "accountNumber": "account-number",
    "name": "the-name",
    "address": "the-address",
    "telephoneNumber": "tel-number",
    "maxConnections": 100,
    "maxRate": 1000,
    "sentOk": 0,
    "errored": 0,
    "bid": 0,
    "noBid": 0,
    "winners": [],
    "requests": []
  }
]
-------------
Publishers:
Publishers:
{
  "111-222-333-444-555": {
    "name": "Really Big Corp.",
    "address": "the-address",
    "telephoneNumber": "tel-number",
    "id": "publisher-id",
    "domain": "junk1.com",
    "campaigns": {
      "banner-campaign": {
        "price": 10.0,
        "served": 0,
        "requested": 0,
        "page": "http://www.rtb4free/sample.html",
        "attributes": [
          "var Impression = Java.type('com.xrtb.privatex.bidrequest.Impression');",
          "im = new Impression().doBanner();",
          "im.id = request.id;",
          "im.instl = 0;",
          "im.banner.setHeight(50);",
          "im.banner.setWidth(320);",
          "im.banner.setPos(0);",
          "request.imp.add(im);",
          "request.device.ua =  cmd.ua;",
          "request.device.geo.lat = cmd.lat;",
          "request.device.geo.lon = cmd.lon;",
          "request.site.cat.add('IAB1');",
          "request.site.cat.add('IAB2');",
          "request.site.ext.rtb4free.platform=cmd.platform;",
          "request.site.ext.rtb4free.connectionType=cmd.connectionType;",
          "request.site.ext.rtb4free.maxDownLink=cmd.maxDownLink;"
        ]
      },
      "video-campaign": {
        "price": 12.0,
        "served": 0,
        "requested": 0,
        "page": "http://www.rtb4free/video-sample.html",
        "attributes": [
          "var Impression = Java.type('com.xrtb.privatex.bidrequest.Impression');",
          "im = new Impression().doVideo();",
          "im.id = request.id;",
          "im.instl = 0;",
          "im.video.setWidth(400);",
          "im.video.setHeight(200);",
          "im.video.setLinearity(1);",
          "im.video.setMinduration(5);",
          "im.video.setMaxduration(30);",
          "im.video.setPos(0);",
          "im.video.addMime('video/x-flv');",
          "im.video.addMime('application/x-shockwave-flash');",
          "im.video.setProtocol(2);",
          "request.imp.add(im);",
          "request.device.ua =  cmd.ua;",
          "request.device.geo.lat = cmd.lat;",
          "request.device.geo.lon = cmd.lon;",
          "request.site.cat.add('IAB1');",
          "request.site.cat.add('IAB2');",
          "request.site.ext.rtb4free.platform=cmd.platform;",
          "request.site.ext.rtb4free.connectionType=cmd.connectionType;",
          "request.site.ext.rtb4free.maxDownLink=cmd.maxDownLink;"
        ]
      }
    }
  }
}
Compiling Nashorn for Really Big Corp.
... banner-campaign ... done.
... video-campaign ... done.
Compilation complete
[2015-07-29 10:11:28.407] - 2 - this-systems-instance-name-here - Exchange/run - Starting on port 8080
[2015-07-29 10:11:28.463] - 0 - this-systems-instance-name-here - initialization - System start on port: 8080
[Thread-3] INFO org.eclipse.jetty.server.Server - jetty-8.1.13.v20130916
[Thread-3] INFO org.eclipse.jetty.server.AbstractConnector - Started SelectChannelConnector@0.0.0.0:9090
[2015-07-29 10:11:30.926] - 5 - this-systems-instance-name-here - ExchageHandler/handle - /banner-sample.html
[2015-07-29 10:11:31.068] - 5 - this-systems-instance-name-here - ExchageHandler/handle - /js/privatex.js
[2015-07-29 10:11:31.156] - 5 - this-systems-instance-name-here - ExchageHandler/handle - /favicon.ico
[2015-07-29 10:11:31.247] - 5 - this-systems-instance-name-here - ExchageHandler/handle - /auction
[2015-07-29 10:11:31.366] - 5 - this-systems-instance-name-here - Auction/requestBids:waiting - Waiting for response from subscribers
[2015-07-29 10:11:31.411] - 5 - this-systems-instance-name-here - Subscriber:the-name:doRequest:sending - http://localhost:8080/rtb/bids/nexage ### {
  "id": "08c3189a-7cf6-48be-8fe4-95a89e38d2f7",
  "at": 2,
  "imp": [
    {
      "id": "08c3189a-7cf6-48be-8fe4-95a89e38d2f7",
      "instl": 0,
      "banner": {
        "pos": 0,
        "w": 320,
        "h": 50,
        "api": 0
      },
      "ext": {
        "rtb4free": {}
      }
    }
  ],
  "site": {
    "id": "publisher-id",
    "name": "Really Big Corp.",
    "domain": "junk1.com",
    "cat": [
      "IAB1",
      "IAB2"
    ],
    "publisher": {
      "id": "publisher-id",
      "name": "Really Big Corp."
    },
    "ext": {
      "rtb4free": {
        "connectionType": "unk",
        "platform": "Linux x86_64",
        "maxDownLink": -1.0
      }
    }
  },
  "device": {
    "ua": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.89 Safari/537.36",
    "connectionType": 0,
    "devicetype": 0,
    "geo": {
      "lat": 33.8409696,
      "lon": -118.3520389,
      "country": "USA"
    }
  },
  "user": {
    "yob": 0,
    "geo": {
      "country": "USA",
      "type": 0
    },
    "ext": {
      "rtb4free": {}
    }
  }
}
[2015-07-29 10:11:31.701] - 5 - this-systems-instance-name-here - Subscriber:the-name:doRequest:response - Good bid received from Subscriber:the-name
[2015-07-29 10:11:31.873] - 5 - this-systems-instance-name-here - Auction/requestBids:complete - Number of bids: 1
MAP: {
  "seatbid": [
    {
      "seat": "99999999",
      "bid": [
        {
          "impid": "23skiddoo",
          "id": "08c3189a-7cf6-48be-8fe4-95a89e38d2f7",
          "price": 5.0,
          "adid": "ben:payday",
          "nurl": "http://localhost:8080/rtb/win/nexage/5.0/33.8409696/-118.3520389/ben:payday/08c3189a-7cf6-48be-8fe4-95a89e38d2f7/http%3A%2F%2Flocalhost%3A8080%2Fforward%3Fpublisher-id/http%3A%2F%2Flocalhost%3A8080%2Fimages%2F320x50.jpg%3Fadid%3Dben:payday%26%2338%3Bbidid%3D08c3189a-7cf6-48be-8fe4-95a89e38d2f7",
          "cid": "ben:payday",
          "crid": "23skiddoo",
          "iurl": "http://localhost:8080/images/320x50.jpg?adid=ben:payday&#38;bidid=08c3189a-7cf6-48be-8fe4-95a89e38d2f7",
          "adomain": "originator.com",
          "adm": "<a href='http://localhost:8080/redirect/ben:payday/nexage/08c3189a-7cf6-48be-8fe4-95a89e38d2f7?url=http://localhost:8080/forward?publisher-id'><img src='http://localhost:8080/pixel/nexage/ben:payday/08c3189a-7cf6-48be-8fe4-95a89e38d2f7/${AUCTION_PRICE}/23skiddoo' height='1' width='1'></img><img src='http://localhost:8080/images/320x50.jpg?adid=ben:payday&#38;bidid=08c3189a-7cf6-48be-8fe4-95a89e38d2f7' height='50.0' width='320.0'></img></a>"
        }
      ]
    }
  ],
  "id": "08c3189a-7cf6-48be-8fe4-95a89e38d2f7",
  "bidid": "08c3189a-7cf6-48be-8fe4-95a89e38d2f7"
}
</code>
</pre>
</div>
</div>     
                
                
                
                <p>If you want to run the private exchange in the background issue a nohup to start the program, like so:
                </p>
                <pre>
$nohup ant > /dev/null &
                </pre>
                <a id="ANATOMY" name="ANATOMY-BANNER"></a>
                <h1>ANATOMY OF A BANNER AD</h1>

                <p>In this section we will put all of the pieces together for the banner ad demonstration web-page.</p>
                <h2>The Web Page With Ad Space for Sale</h2>
                <p>You load this page  <a href="sample" target="_blank">htpp://www.rtb4free.com/privatex/banner-sample.html</a> into your mobile phone's web browser; this will cause the online auction to happen.</p>
                <p>The HTML contents of the web page you are loading can be seen 
                
                <a href=
                "javascript:toggle('togglePage');" id=
                "displayText">here.</a></p>

                <div onclick="javascript:toggle('togglePage');">
                    <div id="togglePage" style=
                    "display:none; border-width:2px; border-style:solid">
<xmp>
<!DOCTYPE html>
<html>
<head>
    <title>Banner-Ad</title>
    <script src=
    "https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="js/privatex.js"></script>
</head>

<body>
    Blah blah blah blah The banner ad will appear below...

    <div id="the-ad-goes-here"></div>
    
    If there was a successful auction, the
    banner is right above us here...<br>
    Blah blah blah blah blah! 

<script>

/*
 * A function that handles no bids
 */
    function doNobid() {
    	alert("The RTB bidder returned no bid!");
    }

/*
 * Set up the parameters for the RTB auction
 */
    params = {};
    params.div = document.getElementById("the-ad-goes-here");
    params.exchangeid = "111-222-333-444-555";
    params.campaign = "banner-campaign";
    params.url = "http://localhost:9090/auction";
    params.nobid = doNobid;
    
/*
 * Do the auction!
 */
    ad = new PrivateRTB(params).perform();

</script> 
</body>
</html>
</xmp>
</div>
</div>

<p>As you can see above, ajax is loaded, and also privatex.js is loaded; this is the secret sauce. When the page
loads in the browser, a JavaScript object <i>PrivateRTB</i> is created. The PrivateRTB auction object uses a paremeter object
to define the particulars of the advertisement. In the Javascript above, this is the <i>params</i> object.</p>
The params.div attribute identifes the DIV where the banner ad is displayed. The web-campaign of the publisher is identified using
the params.campaign parameter. The params.exchangeid parameter defines the publisher's account on the private exchange. The
auction url is defined with params.url. The optional params.nobid parameter is a callback function in case you want to be
notified there was a no bid from the auction.</p>
<p>On the page load PrivateRTB object is created and the perform function is called. The perform causes an AJAX call to the private exchange 
to initiate the processes required to receive the HTML from a winning bid after auction. If Private Exchange found an ad, then the
The PrivateRTB auction object will change the innerHTML of the "the-ad-goes-here" DIV object  with the winning
advertisement's HTML</p>
<p>As you can see here we aren't doing any authentication in this example. In a real system authentication would be required, but 
for demo purposes it just gets in the way and so is not shown.</p>


<h2>Steps in the Process</h2>
<p>The following is the sequence of steps to place the auction for the web page when the user loads the
web page</p>
  <a href=
                "javascript:toggle('toggleRequestAuction');" id=
                "displayText">1 - Request the auction</a></p>

                <div onclick="javascript:toggle('toggleRequestAuction');">
                    <div id="toggleRequestAuction" style=
                    "display:none; border-width:2px; border-style:solid">
<p>When web page loads, the code <i> ad = new PrivateRTB(params).perform();</i> executes, which causes a the PrivateRTB object
to construct a JSON object the private RTB exchange uses to construct an RTB bid request. The PrivateRTB object sends a JSON object that
looks like the following:</p>
<code>
{
  "ua": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.125 Safari/537.36",
  "accountNumber": "111-222-333-444-555",
  "campaign": "banner-campaign",
  "platform": "Linux x86_64",
  "connectionType": "unk",
  "maxDownLink": -1.0,
  "lat": 33.8409696,
  "lon": -118.3520389
}
</code>
</p>
The privatex.js library formats the object with the initialization parameters, and also computes the lat/lon and user agent and sends this
object to the http://rtb4free,com:9090/auction.
</code>
 </div>
 </div>
 
  <a href=
                "javascript:toggle('toggleBidRequest');" id=
                "displayText">2 - Send Bid Requests</a></p>

                <div onclick="javascript:toggle('toggleBidResponset');">
                    <div id="toggleBidRequest" style=
                    "display:none; border-width:2px; border-style:solid">
<p>Upon receiving the provaste exchange request, an Auction is created, and an RTB bid request obhject is created, and sent to the all the
RTB bidders the Private Exchange is connected to. The contents of the private exchange campaign and the web page's PrivateRTB are used
to create the bid request. Here's the bid request:</p>
<code>
{
  "id": "c28fc3cd-7f0f-45b8-a1d9-7da406237993",
  "at": 2,
  "imp": [
    {
      "id": "c28fc3cd-7f0f-45b8-a1d9-7da406237993",
      "instl": 0,
      "banner": {
        "pos": 0,
        "w": 320,
        "h": 50,
        "api": 0
      },
      "ext": {
        "rtb4free": {}
      }
    }
  ],
  "site": {
    "id": "publisher-id",
    "name": "Really Big Corp.",
    "domain": "junk1.com",
    "cat": [
      "IAB1",
      "IAB2"
    ],
    "publisher": {
      "id": "publisher-id",
      "name": "Really Big Corp."
    },
    "ext": {
      "rtb4free": {
        "connectionType": "unk",
        "platform": "Linux x86_64",
        "maxDownLink": -1.0
      }
    }
  },
  "device": {
    "ua": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.125 Safari/537.36",
    "connectionType": 0,
    "devicetype": 0,
    "geo": {
      "lat": 33.8409696,
      "lon": -118.3520389,
      "country": "USA"
    }
  },
  "user": {
    "yob": 0,
    "geo": {
      "country": "USA",
      "type": 0
    },
    "ext": {
      "rtb4free": {}
    }
  }
}
</code>
 </div>
 </div>
 
   <a href=
                "javascript:toggle('toggleBidResponse');" id=
                "displayText">3 - Receive Bid Response</a></p>

                <div onclick="javascript:toggle('toggleBidResponse');">
                    <div id="toggleBidResponse" style=
                    "display:none; border-width:2px; border-style:solid">
<p>Assuming that there is an RTB bidder that has a campaign matching the bid request, an RTB bid is then sent back to the private exchnge.
Here's a copy of one:</p>
<xmp>
<code>
 {
  "seatbid": [
    {
      "seat": "99999999",
      "bid": [
        {
          "impid": "23skiddoo",
          "id": "c28fc3cd-7f0f-45b8-a1d9-7da406237993",
          "price": 5.0,
          "adid": "ben:payday",
          "nurl": "http://localhost:8080/rtb/win/nexage/5.0/33.8409696/-118.3520389/ben:payday/c28fc3cd-7f0f-45b8-a1d9-7da406237993/http%3A%2F%2Flocalhost%3A8080%2Fforward%3Fpublisher-id/http%3A%2F%2Flocalhost%3A8080%2Fimages%2F320x50.jpg%3Fadid%3Dben:payday%26%2338%3Bbidid%3Dc28fc3cd-7f0f-45b8-a1d9-7da406237993",
          "cid": "ben:payday",
          "crid": "23skiddoo",
          "iurl": "http://localhost:8080/images/320x50.jpg?adid=ben:payday&#38;bidid=c28fc3cd-7f0f-45b8-a1d9-7da406237993",
          "adomain": "originator.com",
          "adm": "<a href='http://localhost:8080/redirect/ben:payday/nexage/c28fc3cd-7f0f-45b8-a1d9-7da406237993?url=http://localhost:8080/forward?publisher-id'><img src='http://localhost:8080/pixel/nexage/ben:payday/c28fc3cd-7f0f-45b8-a1d9-7da406237993/${AUCTION_PRICE}/23skiddoo' height='1' width='1'></img><img src='http://localhost:8080/images/320x50.jpg?adid=ben:payday&#38;bidid=c28fc3cd-7f0f-45b8-a1d9-7da406237993' height='50.0' width='320.0'></img></a>"
        }
      ]
    }
  ],
  "id": "c28fc3cd-7f0f-45b8-a1d9-7da406237993",
  "bidid": "c28fc3cd-7f0f-45b8-a1d9-7da406237993"
}
</code>
</xmp>
 </div>
 </div>
 
    <a href=
                "javascript:toggle('toggleAuction');" id=
                "displayText">4 - Auction</a></p>

                <div onclick="javascript:toggle('toggleAuction');">
                    <div id="toggleAuction" style=
                    "display:none; border-width:2px; border-style:solid">
Upon receiving the bid(s) the Private exchange then determines which of the bids will be awarded the win. Upon winning, the RTB bidder is
then notified with a win response. This response looks like:
<xmp>
<code>
 http://localhost:8080/rtb/win/nexage/5.0/33.8409696/-118.3520389/ben:payday/d4d66664-ed70-4b0b-aa38-bcb7c6b8d74e/http%3A%2F%2Flocalhost%3A8080%2Fforward%3Fpublisher-id/http%3A%2F%2Flocalhost%3A8080%2Fimages%2F320x50.jpg%3Fadid%3Dben:payday%26%2338%3Bbidid%3Dd4d66664-ed70-4b0b-aa38-bcb7c6b8d74e
</code>
</xmp>
 </div>
 </div>
 
      <a href=
                "javascript:toggle('toggleServe');" id=
                "displayText">5 - Serve the Ad</a></p>

                <div onclick="javascript:toggle('toggleServe');">
                    <div id="toggleServe" style=
                    "display:none; border-width:2px; border-style:solid">
The winning RTB bidder, upon receiving the notification that it won, then sends the actual HTML to be displayed on the web page. The response
looks like this:</p>
<xmp>
<code>
    <a href=
    'http://localhost:8080/redirect/ben:payday/nexage/c28fc3cd-7f0f-45b8-a1d9-7da406237993?url=http://localhost:8080/forward?publisher-id'>
    <img height='1' src=
    'http://localhost:8080/pixel/nexage/ben:payday/c28fc3cd-7f0f-45b8-a1d9-7da406237993/${AUCTION_PRICE}/23skiddoo'
    width='1'><img height='50.0' src=
    'http://localhost:8080/images/320x50.jpg?adid=ben:payday&#38;bidid=c28fc3cd-7f0f-45b8-a1d9-7da406237993'
    width='320.0'></a>
</code>
</xmp>
 </div>
 </div>
 
       <a href=
                "javascript:toggle('toggleAccounting');" id=
                "displayText">6 - Display</a></p>

                <div onclick="javascript:toggle('toggleAccounting');">
                    <div id="toggleAccounting" style=
                    "display:none; border-width:2px; border-style:solid">
<p>The Jquery call made by the PrivateRTB object for the auction now completes and the HTML from the previous step
is what is passed back to the object. The PrivateRTB object then changes the innerHTML of the div identified in the
div parameter field to this returned HTML:</p>
<xmp>
<code>
div.innerHTML = "<img etc...>";
</code>
</xmp>
<p>Voila, the banner ad appears.</p>
 </div>
 </div>
 
           <a id="ANATOMY" name="ANATOMY-VIDEO"></a>
                <h1>ANATOMY OF A VIDEO AD</h1>

                <p>In this section we will put all of the pieces together for the video ad demonstration web-page.</p>
                <h2>The Web Page With Ad Space for Sale</h2>
                <p>You load this page  <a href="sample" target="_blank">htpp://www.rtb4free.com/privatex/video-sample.html</a> into your mobile phone's web browser; this will cause the online auction to happen.</p>
                <p>The HTML contents of the web page you are loading can be seen 
                
                <a href=
                "javascript:toggle('togglePageVideo');" id=
                "displayText">here.</a></p>

                <div onclick="javascript:toggle('togglePageVideo');">
                    <div id="togglePageVideo" style=
                    "display:none; border-width:2px; border-style:solid">
<xmp>
<!DOCTYPE html>
<html>
<head>

    <script src=
    "https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="js/privatex.js"></script>
    <link href="http://vjs.zencdn.net/4.7.1/video-js.css" rel="stylesheet">
    <link href="vplayer/lib/videojs-contrib-ads/videojs.ads.css" rel=
    "stylesheet" type="text/css">
    <link href="vplayer/videojs.vast.css" rel="stylesheet" type="text/css">
    <style type="text/css">
.description {
      background-color:#eee;
      border: 1px solid #777;
      padding: 10px;
      font-size: .8em;
      line-height: 1.5em;
      font-family: Verdana, sans-serif;
    }
    .example-video-container {
      display: inline-block;
    }
    </style><!--[if lt IE 9]><script src="lib/es5.js"></script><![endif]-->

    <script src="http://vjs.zencdn.net/4.7.1/video.js"></script>
    <script src="vplayer/lib/videojs-contrib-ads/videojs.ads.js"></script>
    <script src="vplayer/lib/vast-client.js"></script>
    <script src="vplayer/videojs.vast.js"></script>

    <title></title>
</head>

<body>
    <p>In the space below, a video about animals of the oceans feeding. But
    first, the page will ask for an advertisement to appear in the video player
    below.</p>

    <p>If the RTB bidder returns an ad for 'Charmin' bath tissue then
    transaction succeeded. If the animals in the sea video plays first, then
    that means there was a no bid from the RTB bidder.</p>
    
    <video autoplay=""
    class='video-js vjs-default-skin' controls="" data-setup='{}' height='300'
    id='vid2' poster='http://video-js.zencoder.com/oceans-clip.png' preload=
    'auto' width='300'>
    <source src='http://video-js.zencoder.com/oceans-clip.mp4' type=
    'video/mp4'>
    <source src='http://video-js.zencoder.com/oceans-clip.webm' type=
    'video/webm'>
    <source src='http://video-js.zencoder.com/oceans-clip.ogv' type=
    'video/ogg'>
    <p>Video Playback Not Supported</p>
    </video><br/>

    <p>Blah blah blah, the web page continues</p>
    
<script>

/*
 * This function will be entered when the video ad is returned, the video
 * player will receive the VAST xml in this function
 */
    function onVideo(vast) {
   		vid2 = videojs('vid2');
    	vid2.muted(false);
    	vid2.ads();
    	vid2.vast({
        	url:  vast
    	});
    }
 
/*
 * A function to handle no bids
 */   
    function onNoBid() {
    	console.log("No bid!");
    }

/*
 * Set up the parameters for the auction on this page
 */
    params = {};
    params.exchangeid = "111-222-333-444-555";
    params.campaign = "video-campaign";
    params.url = "http://localhost:9090/auction";
    params.nobid = onNoBid;
    params.video = onVideo;

/*
 * Do the auction as the page loads
 */
 
    ad = new PrivateRTB(params).perform();

</script> 
</body>
</html>
</xmp>
</div>
</div>
<p>To play video ads in this example we use Videojs with a VAST plugin. You can locate it here <a href="http://vastjs.com" target="_blank">here</a>.  
The VAST plugin is located <a href="https://github.com/theonion/videojs-vast-plugin" target="_blank">here.</a></p>
As you can see above, ajax is loaded, and also privatex.js is loaded; this is the secret sauce. When the page
loads in the browser, a JavaScript object <i>PrivateRTB</i> is created. The PrivateRTB auction object uses a paremeter object
to define the particulars of the advertisement. In the Javascript above, this is the <i>params</i> object.</p>
Unlike the banner ad, there is no params.div, instead, you use params.video to identify a JavaScript function that will
dynamically access the video player. The web-campaign of the publisher is identified using
the params.campaign parameter. The params.exchangeid parameter defines the publisher's account on the private exchange. The
auction url is defined with params.url. The optional params.nobid parameter is a callback function in case you want to be
notified there was a no bid from the auction.</p>
<p>On the page load PrivateRTB object is created and the perform function is called. The perform causes an AJAX call to the private exchange 
to initiate the processes required to receive the HTML from a winning bid after auction. If Private Exchange found an ad, then the
The PrivateRTB auction object calls your onVideo() function. The <i>data</i> parameter is a an object that contains a vast attribute 
which has the VAST XML, and optionally, a <i>url</i> object which defines the URL of the VAST if your player wants an http entry for
retrieving the VAST itself. XRTB and Private Exchange support sending this non-standard <i>url</i> attribute back as the player
we use cannot accept the raw VAST, but instead wants to load it itself.
advertisement's HTML</p>
<p>As you can see here we aren't doing any authentication in this example. In a real system authentication would be required, but 
for demo purposes it just gets in the way and so is not shown.</p>
</div>    
</div>

<h2>Steps in the Process</h2>
<p>The following is the sequence of steps to place the auction for the web page when the user loads the
web page with an embedded video object</p>
 
  <a href=
                "javascript:toggle('toggleRequestAuctionVideo');" id=
                "displayText">1 - Request the auction</a></p>

                <div onclick="javascript:toggle('toggleRequestAuctionVideo');">
                    <div id="toggleRequestAuctionVideo" style=
                    "display:none; border-width:2px; border-style:solid">
<p>When web page loads, the code <i> ad = new PrivateRTB(params).perform();</i> executes, which causes a the PrivateRTB object
to construct a JSON object the private RTB exchange uses to construct an RTB bid request. The PrivateRTB object sends a JSON object that
looks like the following:</p>
<code>
{
  "ua": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.125 Safari/537.36",
  "accountNumber": "111-222-333-444-555",
  "campaign": "video-campaign",
  "platform": "Linux x86_64",
  "connectionType": "unk",
  "maxDownLink": -1.0,
  "lat": 33.8409696,
  "lon": -118.3520389
}
</code>
</p>
The privatex.js library formats the object with the initialization parameters, and also computes the lat/lon and user agent and sends this
object to the http://rtb4free,com:9090/auction.
</code>
 </div>
 </div>
 
  <a href=
                "javascript:toggle('toggleBidRequestVideo');" id=
                "displayText">2 - Send Bid Requests</a></p>

                <div onclick="javascript:toggle('toggleBidRequestVideo');">
                    <div id="toggleBidRequestVideo" style=
                    "display:none; border-width:2px; border-style:solid">
<p>Upon receiving the provaste exchange request, an Auction is created, and an RTB bid request object is created, and sent to the all the
RTB bidders the Private Exchange is connected to. The contents of the private exchange campaign and the web page's PrivateRTB are used
to create the bid request. Here's the bid request:</p>
<code>
{
  "id": "6d444144-b301-4105-b158-d54e194f807b",
  "at": 2,
  "imp": [
    {
      "id": "6d444144-b301-4105-b158-d54e194f807b",
      "instl": 0,
      "video": {
        "protocol": 2,
        "linearity": 1,
        "maxduration": 30,
        "pos": 0,
        "w": 400,
        "h": 200,
        "minduration": 5,
        "mimes": [
          "application/x-shockwave-flash"
        ]
      },
      "ext": {
        "rtb4free": {}
      }
    }
  ],
  "site": {
    "id": "publisher-id",
    "name": "Really Big Corp.",
    "domain": "junk1.com",
    "cat": [
      "IAB1",
      "IAB2"
    ],
    "publisher": {
      "id": "publisher-id",
      "name": "Really Big Corp."
    },
    "ext": {
      "rtb4free": {
        "connectionType": "unk",
        "platform": "Linux x86_64",
        "maxDownLink": -1.0
      }
    }
  },
  "device": {
    "ua": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.125 Safari/537.36",
    "connectionType": 0,
    "devicetype": 0,
    "geo": {
      "lat": 33.8409696,
      "lon": -118.3520389,
      "country": "USA"
    }
  },
  "user": {
    "yob": 0,
    "geo": {
      "country": "USA",
      "type": 0
    },
    "ext": {
      "rtb4free": {}
    }
  }
}
</code>
 </div>
 </div>
 
   <a href=
                "javascript:toggle('toggleBidResponseVideo');" id=
                "displayText">3 - Receive Bid Response</a></p>

                <div onclick="javascript:toggle('toggleBidResponseVideo');">
                    <div id="toggleBidResponseVideo" style=
                    "display:none; border-width:2px; border-style:solid">
<p>Assuming that there is an RTB bidder that has a campaign matching the bid request, an RTB bid is then sent back to the private exchnge.
Here's a copy of one:</p>
<xmp>
<code>
{
  "seatbid": [
    {
      "seat": "99999999",
      "bid": [
        {
          "impid": "iAmVideo",
          "id": "6d444144-b301-4105-b158-d54e194f807b",
          "price": 5.0,
          "adid": "ben:payday",
          "nurl": "http://localhost:8080/rtb/win/nexage/5.0/33.8409696/-118.3520389/ben:payday/6d444144-b301-4105-b158-d54e194f807b/null/null",
          "cid": "ben:payday",
          "crid": "iAmVideo",
          "iurl": "null",
          "adomain": "originator.com",
          "adm": "http%3A%2F%2Flocalhost%3A8080%2Fvast%2Fonion270.xml"
        }
      ]
    }
  ],
  "id": "6d444144-b301-4105-b158-d54e194f807b",
  "bidid": "6d444144-b301-4105-b158-d54e194f807b"
}
</code>
</xmp>
 </div>
 </div>
 
    <a href=
                "javascript:toggle('toggleAuctionVideo');" id=
                "displayText">4 - Auction</a></p>

                <div onclick="javascript:toggle('toggleAuctionVideo');">
                    <div id="toggleAuctionVideo" style=
                    "display:none; border-width:2px; border-style:solid">
Upon receiving the bid(s) the Private exchange then determines which of the bids will be awarded the win. Upon winning, the RTB bidder is
then notified with a win response. This response looks like:
<xmp>
<code>
 http://localhost:8080/rtb/win/nexage/5.0/33.8409696/-118.3520389/ben:payday/d4d66664-ed70-4b0b-aa38-bcb7c6b8d74e/http%3A%2F%2Flocalhost%3A8080%2Fforward%3Fpublisher-id/http%3A%2F%2Flocalhost%3A8080%2Fimages%2F320x50.jpg%3Fadid%3Dben:payday%26%2338%3Bbidid%3Dd4d66664-ed70-4b0b-aa38-bcb7c6b8d74e
</code>
</xmp>
 </div>
 </div>
 
      <a href=
                "javascript:toggle('toggleServeVideo');" id=
                "displayText">5 - Serve the Ad</a></p>

                <div onclick="javascript:toggle('toggleServeVideo');">
                    <div id="toggleServeVideo" style=
                    "display:none; border-width:2px; border-style:solid">
The winning RTB bidder, upon receiving the notification that it won, then sends the VAST data to be sent to the video player. Note however
in our player we can;'t use the VAST directly, so we instead pass the HTTP location of the VAST data as a file. The response
looks like this:</p>
<xmp>
<code>
http%3A%2F%2Flocalhost%3A8080%2Fvast%2Fonion270.xml
</code>
</xmp>
 </div>
 </div>
 
       <a href=
                "javascript:toggle('toggleAccountingVideo');" id=
                "displayText">6 - Display</a></p>

                <div onclick="javascript:toggle('toggleAccountingVideo');">
                    <div id="toggleAccountingVideo" style=
                    "display:none; border-width:2px; border-style:solid">
<p>The Jquery call made by the PrivateRTB object for the auction now completes and the HTML from the previous step
is what is passed back to the object. The PrivateRTB object then calls the onVideo() function which contains the code to load either
the VAST data that was returned, or, in this case, we pass it the HTTP address of the VAST file, as that is what our Videojs player
requires.<p>
<code>
   function onVideo(vast) {
   		vid2 = videojs('vid2');
    	vid2.muted(false);
    	vid2.ads();
    	vid2.vast({
        	url:  vast
    	});
    }
</code>
<p>Voila, the banner ad appears.</p>
 </div>
 </div>
 
 
     			<a id="THEORY" name="THEORY"></a>
                <h1>THEORY</h1>
<p>The theory of operation is pretty simple. The web page that is requesting an ad will contact a private exchange that has
a campaign that defines the parameters for the advertisements the web page onwer is looking for. Using a Javascript API when
the page loads, the web page makes an Ajax call to the private exchange with the name of the campaign, and whatever
personal information is available to the API.</p>
<p>When the exchange gets the Ajax call it creates a bid request object that is sent to all the RTB exchanges connected to the exchange.</p>
<p>The RTB bidders will then respond back with bids (if applicable) and the exchange will sort them and choose the winning bid on behalf
of the web page making the Ajax call.<.p>
<p>The exchange notifies the winning bidder and it in turn responds with the ad markup. HTML in the case of a banner ad, or VAST XML
in the case of a VAST based video ad.</p>
<p>The private exchange then returns the VAST ot HTML as the case may be to the web page making the original Ajax call.</p>
<p>The challenge is, to scale, you may actually have multiple instances of the Exchange running behind a load balancer, and then, you may have many (possibly thousands) of network
connections to the bidders.</p>
<p>To handle this chaos, RTB4FREE uses the Redisson based shared java objects, that are based on REDIS to keep the system synchronized.</p>
First, you likely may have multile Exchanges running behind a load balancer. The web page will make an Ajax call, and the ad markup
thay (may) eventually be served will return on this same connection. This is the easy part</p>
<p>Upon receiving the Ajax call from the web page the Exchange creates an AuctionRequest object. This ibject reads the JSON from the web page and locates the 
appropriate Publisher object that defines the campaign. The Publisher object is a Redisson shared object that defines the web page publisher. The Publisher
will have one or more Campaign objects, that are also shared objects. Sharing these objects means multiple Exchange instances can be used simultaneously.</p>
<p>Once a campaign is located that matches the Ajax provided  campaign-id</p>
<p>The AuctionRequest creates an Auction object for the campaign. This Auction object takes the Javascript definition of the campaign and
executes it along with the JSON object passed in the Ajax call. This execution results in the creation of an RTB Bid request object. Once
this object is created. A Redisson RList object is created with a UUID (the vid request id). The Auction object transmits the 
BidRequest object to the'Redisson topic 'bidrequests'. Now the Auction waits for 500 milliseconds, and at the end of that time, checks
to see how many objects (the bids, if any) have appeared in the RList for the UUID it just created. If there are objects
in this RLIst, then the highest priced bid is chosen</p>
<p>The Auction object then creates a Redisson RCountDownLatch for the UUID (bid id). The Subscriber object that handled the winning bid puts it's
topic address into the bid, and now, the Auction object transmits the win notification to the Subscriber's topic and waits on the RCountDownLatch. 
When the Subscriber handles the win, it sets the RCountDownLatch to 0, and this wakes the Auction object up. The Auction object
retrieves an RBucket Redisson object of the UUID (bid id), if it exists, the Subscriber has sent the ADM field back in it. If it is null
then the Subscriber did not answer (in effect, no ad is available). The latch and the bucket is deleted, the Auction completes, the AuctionRequest object
retrieves the returned ADM, and the Exchange retrieves the ADM from the AuctionRequest and then sends it back to the calling
web page</p>
<p>The Subscriber is an object that is created on behalf on an RTB Bidder. It is the Subscriber that makes an HTTP connection to the
RTB Bidding engine and sends/receives requests/bids/notifications. All Subscriber objects listen asynchronously to the Redisson 'bidrequests' topic.
Upon receiving a Bid Request, it is transmitted on the HTTP connection(s) to the RTB bidder. The bid request has a UUID, and
for each UUID there is an RList object of that name created by the Auction.  If a Bid is returned, to the Subscriber, it
simply copies the bid onto the RList of that same UUID. This way multiple Subscribers can process bid requests in a fan-out configuration</p>
Subscribers also asynchronously listen to it's own topic that is set tot the RTB subscriber account number. When the bid is copied to 
the RList, the RCountDownLatch is decremented letting the Auction know there are bids available. The account numebr of the Subscriber is added to the 
bid, this is where any win notifications will come from. If a win notification comes in on the Subscriber's topic, the win notification
is sent to the RTB bidder, and its response will be copied to an RBucket of the same name as the bid id.<p>


      			<a id="DEPENDENCIES" name="DEPENDENCIES"></a>
                <h1>DEPENDENCIES</h1>
 
    <footer>
        <p>&copy; Ben M. Faul, Peter Loh, RTB4FREE.ORG 2015</p>
        <p>Email: Ben.Faul@gmail.com</p>
    </footer><br>
    <script type="text/javascript">

    function toggle(elementId) {
    var ele = document.getElementById(elementId);
    if(ele.style.display == "block") {
            ele.style.display = "none";
    }
    else {
        ele.style.display = "block";
    }
    } 

    </script> <!-- Bootstrap core JavaScript
    ================================================== -->
     <!-- Placed at the end of the document so the pages load faster -->
     <script src=
    "https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script> <script src="../../dist/js/bootstrap.min.js"></script> <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
     <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script> <script src="offcanvas.js"></script>
</body>
</html>